\chapter{Diffusion MRI analysis}\label{chap:neuroimaging}

Having given a brief introduction to the principles neuroanatomy and \gls{dmri} physics and image formation, we will turn now to the modern developments in applying \gls{dmri} to qualitative and quantitative analysis of \gls{wm} organisation.
This chapter will take us through early to state-of-the art uses of \gls{dmri} as a \gls{wm} imaging tool and outstanding challenges.

Though the tools for studying the structure and function of neural connectivity are numerous, \gls{dmri} remains the only available technique capable of investigating microscopic \gls{wm} structure of the entire human brain \textit{in vivo}.
% This is thanks to the \note{fibrous} organisation of \gls{wm} fibres, which group together in bundles forming a restrictive diffusion environment in which axon membranes and myelin sheaths form barriers to diffusing water molecules.
% The resulting anisotropic diffusion pattern, with preferential diffusion along the axon direction, forms the basis for \gls{dmri}-based \gls{wm} analysis.
Though the mechanism of diffusion-weighted signal is well understood (see section \ref{sec:dmri}), its correct interpretation hinges on an understanding of how diffusion is affected by the microstructural environment\autocite{LeBihan1995}, or even by just those features of the microstructural environment we are interested in measuring.
It is not obvious, for example, how much of diffusion within a voxel filled with myelinated axons can be best characterised as either hindered or restricted, and how properties such as axon density and diameter might contribute to the observed signal.\autocite{Panagiotaki2012}

\Gls{dmri} image \glspl{voxel} are on the order of cubic millimetres, and in such a volume are contained thousands of individual axons, with average diameters of around 1$\mu m$\autocite{Liewald2014,Lampinen2019}.
What's more, rarely are all axons within a voxel uniformly aligned with a single direction.
Throughout the brain, fibre tracts mingle and intersect, bend and fan out.\autocite{Jeurissen2013,Alexander2019}
The physical diffusion processes in such complex configurations and multicellular environments cannot be known, only approximated and modelled through a choice of assumptions and simplifications.
In this there are, of course, many contrasting approaches, developed for different applications and the directed study of specific quantities and microstructural features.
Such target properties of \gls{dmri} analysis include cellular composition of \gls{gm}, axon density and myelination, intra- and extracellular water content, and diffusivity perpendicular to axonal orientation.
Collectively, these scalar parameters are fit from a family of microstructural models known collectively as multi-compartment models, so named for their separation of the measured signal into isolated compartments representing, for example, intra-axonal or extracellular space, each with different diffusion patterns.\autocite{Panagiotaki2012,Alexander2019}
These parameters could capture virtual cytohistological information and even serve as biomarkers for disease\autocite{Alexander2008}.
For the purposes of studying macroscopic brain connectivity and the course and organisation of individual \gls{wm} fibre tracts, the key information of interest to be determined from raw \gls{dmri} is the distribution of axonal orientations within each voxel described by a \gls{fod}.

\section{Tissue microstructure  and fibre orientation modelling}


The first approach for modelling fibre orientations came in the form of \gls{dti}, which remains one of the dominant diffusion models in many applications today, particularly in clinical contexts.
The diffusion process within a \gls{wm} voxel is modelled as a three dimensional Gaussian distribution, whose covariance matrix is proportional to the diffusion \textit{diffusion tensor}\autocite{Basser1994,ODonnell2011} $\mathbf{D}$:
\begin{equation}
  \mathbf{D} = \begin{pmatrix}
                D_{xx} & D_{xy} & D_{xz}\\
                D_{yx} & D_{yy} & D_{yz} \\
                D_{zx} & D_{zy} & D_{zz}
                \end{pmatrix} \label{eq:dt}
\end{equation}
At least six unique directions are required to fully determine $\mathbf{D}$ (which is diagonally symmetric, i.e. $D_{ij} = D_{ji}$), although the diagonal components, sufficient for measuring \gls{adc} as previously described in (\ref{eq:trace}--\ref{eq:adc}), may be determined from only three orthogonal measurements.

By diagonalising $\mathbf{D}$, which is symmetric and positive-definite, three orthogonal eigenvectors and corresponding eigenvalues $\lambda_1 \geqslant \lambda_2 \geqslant \lambda_3$ can be computed.
Rotationally invariant indices including mean diffusivity and \gls{fa} provide scalar quantities which can be interpreted in terms of underlying tissue properties, the latter being given by
\begin{equation}
  FA = \sqrt{\frac{3}{2}}\frac{\sqrt{(\lambda_1 - \langle \lambda \rangle)^2 + (\lambda_2 - \langle \lambda \rangle)^2 + (\lambda_3 - \langle \lambda \rangle)^2}}{\sqrt{\lambda_1^2 + \lambda_2^2+ \lambda_3^2}}
\end{equation}
The principal eigenvector $\bm{\lambda}_1$ is usually interpreted as the direction of fastest, or least restricted, diffusivity, although this holds only in voxels with a single population of straight, parallel axons.
If the diffusion tensor, whose eigenvectors and eigenvalues can be represented in the form of an ellipsoid shaped surface of equal mean displacement, is used as a rudimentary approximation of the \gls{fod}, then $\bm{\lambda}_1$ is taken as the single peak orientation of axon fibres.
Depicting peak orientations is achieved through \gls{dec} mapping, in which directions are mapped to colours in RGB space, where the $x$-axis, or medial-lateral / left-right direction is assigned pure red, the $y$-axis, or posterior-anterior direction is assigned pure green, and the $z$-axis, or inferior-superior direction, is assigned pure blue.
\Gls{dti} images are often depicted as \gls{dec} \gls{fa} (or ``colour \gls{fa}) maps, where a voxel's colour is determined by $\lambda_1$ and its brightness by the \gls{fa} value.

In fact, it is rare for a voxel of \gls{wm} to contain only a single uniformly oriented bundle of axons.
In so-called crossing fibre voxels, where at least two distinctly oriented fibre populations reside, the diffusion tensor provides a woefully inaccurate or misleading picture:
A smaller population with a low signal contribution may be entirely unrepresented in the modelled \gls{odf} peak, or else the effect is one of averaging all contributing populations such that none of the actual underlying fibre directions are indicated by the \gls{dt} eigenvectors (Fig. \ref{fig:cross}).

\begin{figure}
  \centering
  \includesvg[width=0.6\textwidth,pretex=\small\sffamily]{chapter_2/fods.svg}
  \caption{Popular \gls{dmri} modelling techniques produce different estimates of the underlying fibre orientations. In a voxel with a single population of fibres (top row), both the diffusion tensor and \gls{csd} derived \gls{fod} capture the dominant fibre orientation. If two fibre bundles cross within a voxel (bottom row), the diffusion tensor does not accurately estimate any of the dominant fibre orientations, whereas the \gls{fod} is able to resolve both populations.}
  \label{fig:cross}
\end{figure}

The crossing fibres problem led to \gls{dti}, at least in research imaging, gradually giving way to higher-order fibre orientation modelling techniques which aim to account for more than one, or even an arbitrary number of distinctly oriented fibre populations\autocite{Alexander2005}.
These include to an extent the multi-compartment models which can include multiple directional intra-axonal compartments, such as the popular ``ball and sticks'' model\autocite{Behrens2003,Behrens2007}.
Alternatively, several approaches aim to retrieve an underlying orientation distribution with arbitrary number of peaks through transforming the raw signal \gls{odf} into a spherical distribution of diffusivity or correlates thereof.
Diffusion spectrum imaging (DSI)\autocite{Wedeen2008}, and the less data-demanding Q-ball imaging\autocite{Tuch2003,Tuch2004}, are examples of methods that reconstruct a distribution of water molecule displacement (\gls{dodf}), with peaks aligned with the (presumed) fibre orientation.
Deconvolution methods begin with the premise that a single population of parallel fibres will produce a characteristic \gls{dmri} signal profile.
Then, the observed signal $S(\theta,\phi)$ in a given voxel amounts to a convolution over the fibre orientation distribution function $F(\theta,\phi)$ with this single fibre ``response'' kernel $R(\theta)$:
\begin{align}
  S(\theta,\phi) = F(\theta,\phi) \otimes R(\theta)
\end{align}\label{eq:csd}
Solving (\ref{eq:csd}) for $F(\theta,\phi)$, represented in spherical harmonics basis as given by (\ref{eq:shfun}), involves computing the inverse operation:
A spherical \textit{de}convolution of the signal with the response function.
Early versions of this concept included \textcite{Anderson2005}, in which the response kernel was modelled as a diffusion tensor.
In another approach presented by \textcite{Tournier2004} $R(\theta)$ is estimated directly from the data, generally by averaging the signals from voxels with the highest diffusion anisotropy, and thus does not rely on a model of diffusion, although it does rely on the assumption that a single fibre population's response is uniform throughout the brain and for different fibre configurations.
To improve angular resolution and reduce noise sensitivity in the estimated \gls{fod}, a regularised implementation in which biophysically impossible negative $F(\theta,\phi)$ values are strongly penalised gave rise to the widely used \gls{csd} method (Fig. \ref{fig:cross}).
\Gls{csd} can reconstruct \glspl{fod} resolving multiple crossing fibre populations with high angular resolution in a matter of seconds, from \gls{dmri} datasets with acquisition parameters achievable in routine imaging practice\autocite{Tournier2013}.
In addition to providing a means for estimating the \gls{fod} to a high degree of angular resolution, \gls{csd} also spurred exploration of new quantities relating to tissue microstructure, notably the interpretation of the \gls{fod} amplitude as measure of intra-axonal volume fraction, or \gls{afd} \autocite{Raffelt2012a}.
\Gls{afd} can be defined as a directional quantity or as a single scalar per voxel, obtained by integrating $F$ over the sphere.

By design, \gls{csd} presumes that the entire signal in a voxel can be explained by contributions from a number of fibre populations, each forming a highly restrictive environment in which diffusion is anisotropic.
Within pure and highly organised \gls{wm}, this is a reasonable assumption, however limitations become apparent outside of these areas.
As we have seen in previous sections, brain tissue covers a spectrum of cytoarchitectures and a corresponding diversity in diffusion environments.
At the typical resolutions of \gls{dmri} data, voxels may contain, in addition to axon fibres, signal contributions from \gls{csf} or \gls{gm}, which are typically characterised by isotropic and freer diffusion.
The result of such partial volume effects are highly noisy \gls{fod} estimates with spurious peaks, overestimation of \gls{fod} peak amplitudes and overestimation of \gls{afd} in affected voxels.\autocite{Jeurissen2014}
In addition, the original \gls{csd} method was designed only for data acquired with a single diffusion weighting $b$ factor (``shell''), unable to take advantage of the additional information contained in more advanced and increasingly popular multi-shell acquisitions.
To address these limitations, an extension proposed in \textcite{Jeurissen2014} and referred to as \gls{msmt} \gls{csd} includes support for multiple $b$-value shells and separation of the signal into contributions from different tissue compartments, typically \gls{wm}, \gls{gm}, and \gls{csf}, each with their own characteristic response functions.
The resulting \gls{fod} estimates have higher angular precision than \gls{ssst} \gls{csd}, with fewer noisy spurious lobes to confound downstream processing and interpretation.
Furthermore, separation of the isotropic signal contributions greatly improves the interpretation of \gls{fod} amplitude as a measure of \gls{afd}, as the amplitudes of each tissue's deconvolved \gls{odf} closely correspond to their respective tissue volume fractions\autocite{Jeurissen2014}.

\begin{SCfigure}
  \includegraphics[width=0.5\textwidth]{chapter_1/coronalwm.png}
  \caption{Coronal section of the author's white matter, imaged with \gls{csd} \gls{dec} mapping and streamline tractography. The \glspl{cst} are visible radiating from the cortex to converge in the internal capsules before descending through the anterior pons, perpendicular to the middle cerebellar peduncle fibres. Either side of the pons, the trigeminal nerves (cranial nerve V) are visible as small green dots.}
  \label{fig:corwm}
\end{SCfigure}

\section{Streamline tractography}\label{sec:tractography}

% \note{Discuss as the mainstay of white matter bundle segmentation.
% Cover fundamentals (including what it isn't), det/prop, different fibre models, virtual dissection, the usual suspects}

Up to this point, we have only discussed the processing and analysis of \gls{dmri} data, and what it can or cannot reveal about \gls{wm} microstructure, at the level of individual image \glspl{voxel}.
However, the individual axons that form fibre tracts can traverse 100s of millimetres, and with the unique ability to measure fibre orientations in each voxel it wasn't long before this information was being exploited to reconstruct axonal connections in their entirety.
The basic principle is one of treating fibre orientations as a brain-wide vector field through which the paths of virtual neural fibres can be traced in a process called streamline tractography (or simply tractography).
It is vital to note here that the paths of individual \textit{in vivo} axons are entirely indiscernible from \gls{dmri}.
The individual streamlines of tractography are entirely abstract mathematical objects, each a collection of vertices, which aim to capture the \textit{potential} pathways of axons consistent with the observed \glspl{fod} representing an ensemble of thousands of axons.
Tractography is an immensely powerful and useful tool, and at the same time full of flaws due to this abstract and indirect nature.
All tractography algorithms consist at their core of the following steps:

\begin{lstlisting}[language=bash,label={lst:track},frame=single]
streamlines = []
while length(streamlines) < N do
  streamline = [get_seed_vertex()]
  STOP = false;
  while not STOP
    vertex = streamline[end]
    v = get_local_direction(vertex)
    new_vertex = vertex + step_size*v
    append(streamline, new_vertex)
    STOP = evaluate_stop(new_vertex)
  append(streamlines, streamline)
\end{lstlisting}

Once a predefined number of streamlines which fulfil all selection criteria have been generated, tracking is terminated, and the resulting streamlines, each consisting of a set of vertices in 3D space, maybe further analysed or visualised as required.
Volumetric images can also be generated by computing the number of streamlines in each voxel on a predetermined grid, a technique referred to as \gls{tdi}\autocite{Calamante2010}.

\begin{figure}
  \includegraphics[width=\textwidth]{chapter_2/streamlines.png}
  \caption{Streamline tracking involves tracing trajectories through a vector field of inferred dominant fibre orientations. Two example streamlines, from the \gls{cst} (blue) and \gls{cc} (blue) are depicted in a coronal slice of the human brain. Figure reproduced from \textcite{Jeurissen2019} licensed under \href{https://creativecommons.org/licenses/by-nc/4.0/}{CC-BY-NC 4.0}.}
  \label{fig:tracking}
\end{figure}

Within the simple algorithm outlined above are a plethora of parameters and decisions which which have transformative effects on the result.
They are apparent in the undefined functions such as \verb|get_local_direction()| or \verb|get_seed_vertex()| and the scalar parameters \verb|step_size| and \verb|N|.
The seed location, step length, conditions for terminating or entirely rejecting streamlines, interpolation of the surrounding vector field, number of streamlines to generate, are all choices to be made by the user (although in practice many parameters will be automatically determined or set to default values by the chosen algorithm).
There are two choices that most fundamentally affect the tractography process and which feature most heavily in discussions on its use.

First is the choice of method for representing orientation information from the underlying data.
The earliest tractography algorithms were developed almost concurrently with \gls{dti}\autocite{Mori1998,Mori1999}, with the orientation vector field constructed from the principal eigenvectors of fitted diffusion tensors.
In the \gls{fact} algorithm proposed by \textcite{Mori1999}, the local direction for each vertex is assigned from $\bm{\lambda}_1$ of the current voxel, and the stop criterion is a measure of neighbourhood fibre collinearity falling below a predefined threshold.
With only a single possible propagation direction at each location, which, as discussed above, may throughout much of the brain have little to do with any true axon orientations at that point, diffusion tensor-based tractography can only track fibre pathways with rather limited accuracy.
Streamlines may continue happily along a physiologically plausible path until encountering a region of intersecting tracts, at which point it may be prematurely terminated or diverted onto the trajectory of this intersecting tract if a continuation of the current path is entirely unsupported by the principal eigenvector field.

It becomes clear when considering what we learned about neural connections in section \ref{sec:hodology}, about compact fibre bundles diverging to distributed cortical targets, that a single dominant fibre direction at every point is incompatible with the dynamic organisation of \gls{wm} tracts, and the result is a tendency to reconstruct narrow and incomplete fibre bundles\autocite{Farquharson2013}.
A well cited example of this limitation can be seen in reconstructions of the \gls{cst}, which arises from the entire motor cortex from the apex down to the Sylvian fissure, but which is rendered by \gls{dt}-based algorithms only as a vertical pathway without any lateral projections.
Against this background, tractography based on higher-order fibre orientation models represents a vast improvement in the ability to contend with tracking in the complex configurations of \gls{wm}.
Now when two perpendicular tracts occupy the same voxel, the possible tracking direction is not limited to either that of the dominant bundle such that tracking the smaller one is impossible, or of an average of the two such that neither is properly represented.
However, with the flexibility of multi-peak distributions comes ambiguity, as when there are multiple distinct possible directions in which to propagate the streamline at any position, the decision of which direction to take becomes far more complex.
While tensor-based tractography may be particularly prone to false negatives, or neglecting certain pathways, multi-peak tractography can easily produce false-positives by hopping onto the paths of intersecting tracts.

The second significant distinction is between deterministic and probabilistic tracking approaches.
In deterministic tractography, there is only one single direction in which a streamline can be propagated from any given point, and two streamlines seeded in exactly the same location will be identical.
But the certainty implied by this deterministic approach is at significant odds with the reality that tractography operates in a domain and resolution far removed from that of individual axons.
Probabilistic tractography algorithms are here to acknowledge the uncertainty inherent in the tracking process.
Numerous probabilistic tracking algorithms have been developed, and while the end effect is essentially the same, whereby the next step direction is sampled from a probability distribution instead of deterministically selected, and seeding in the exact same location will not give rise to identical streamlines, there are two subtly different schools in what sort of uncertainty is being considered\autocite{Jeurissen2019}.
One considers the \textit{measurement} uncertainty of the calculated orientations.
Under this approach, the general direction to take is not under question, but the accuracy of that direction is.
It holds that due to noise and inherent limitations in our measurement equipment and signal modelling, the fibre orientations can only be calculated with limited accuracy, and the tracking directions are sampled from a distribution reflecting this measurement uncertainty.
The probabilistic algorithm probtrackx\autocite{Behrens2007}, based on the ball-and-sticks fibre orientation model\autocite{Behrens2003}, is a notable example of this approach.

A second school takes the view that uncertainty in the choice of streamline step direction stems from the obscurity of the underlying physiological reality, and sampling that direction from the fibre \gls{odf} reflects that microstructural complexity.
Crucially though, tracking is not proceeding under any guidance relating to real biophysical connections, and though a streamline's direction in a given voxel may well be in accordance with real axons, whether that direction is appropriate in the context of the preceding steps of the same streamline is unresolvable.
In other words, \gls{fod}-based probabilistic tractography, of which first or second-order integration over \glspl{fod}  (iFOD1/iFOD2)\autocite{Tournier2012,Tournier2010} are notable examples, can capture the local dispersion of fibres in high detail, but that doesn't necessarily translate to long-range accuracy.
It is possible to constrain tractography according to broad heuristics about fibre tract geometries, but inevitably such simplifications will not be globally applicable.
For example, strategies to prevent streamlines from ``hopping'' onto intersecting, but not physically connected, pathways can include placing upper limits on the angle between successive steps under the expectation that most tracts will carry more or less straight on, but there are plenty of tracts in the brain with regions of high curvature, which become much harder to accurately reconstruct if the ``straight ahead'' constraint is too strict.

Due to streamline tractography's locally oriented and step-by-step nature, errors and missteps accumulate rapidly with little to no opportunity to correct them, resulting in some wildly implausible streamlines.
Attempts to address this blindness to biophysical reality are at the focus of much of modern tractography research\autocite{Bastiani2017,Rheault2019,Aydogan2021}, as the consequences of these ongoing challenges to connectivity research and neurology are substantial\autocite{Schilling2019, Yang2021, Grisot2021}.

\section{Segmenting white matter tracts with tractography}

The functional division of white matter into distinct tracts is of great consequence to neuroscience, psychology and neurology in their efforts to analyse brain structure and function, and as we will see later, identifying tracts is also of vital importance in neurosurgery.
It follows that the spatial delineation of individual tracts is a key step in many \gls{dmri} analysis pipelines.

Streamline tractography was the first, and remains the dominant answer to this task.
Though the field is wide and the specific approaches numerous, we will outline the two main frameworks through which individual tract segmentations are derived using streamline tractography.
The first, sometimes dubbed ``virtual fibre dissection'', involves generating a large number (on the order of 10s of millions) of streamlines, usually covering the entire brain, followed by a selection process whereby streamlines are assigned to a tract of interest or discarded.
Streamline tracking proceeds virtually uninhibited, terminating only if a maximum length is reached or when leaving the white matter (as indicated by tissue segmentations\autocite{Smith2012} or a \gls{fod} amplitude threshold).
After tracking, one approach for selecting streamlines belonging to the target bundle is to use logical \glspl{roi}, specifying inclusion volumes which must be visited and exclusion volumes to filter unwanted tracks.
These selection and exclusion \glspl{roi} encapsulates our \textit{a priori} neuroanatomical knowledge, and the resulting bundle, comprising only those streamlines fulfilling the criteria, represents the segmented tract (Fig. \ref{fig:tg_rois}).
The streamlines may be viewed as three-dimensional objects, or further processed into volumetric streamline density maps\autocite{Calamante2010} and thresholded binary segmentations.

Alternatives to \gls{roi}-based selection are clustering methods, which classify streamlines according to their proximity or similarity to each other, or other geometrical properties.
RecoBundles\autocite{Garyfallidis2018}, White Matter Analysis \autocite{ODonnell2017, ODonnell2007}, atlas based adaptive clustering \autocite{Tunc2014}, and example-based automatic tract labelling \autocite{Yoo2015} are all examples of data driven, group-wise streamline clustering and matching approaches.
They typically rely on registration of example data or streamline atlases based on which similar streamlines are recognised in the target data and labelled accordingly.
Streamline clustering methods have been shown to generate more consistent and reproducible results across subjects compared to \gls{roi}-based segmentation\autocite{Sydnor2018}.
Another approach, named Classifyber, uses a learned linear classification of streamline features to label streamlines belonging to the target bundle in a new subject \autocite{Berto2021}.
In all clustering approaches, the necessary generation of whole brain tractograms in test subjects and the additional construction of example or reference tractography data present barriers to application, as well as, in some cases, long processing times and high memory requirements\autocite{Wasserthal2018}.

The whole brain approach is computationally extremely wasteful, as the vast number of streamlines generated will not even represent \textit{any} anatomically valid pathway through the brain, let alone one belonging to the tract of interest.
Furthermore, if streamlines are randomly seeded throughout the brain, then longer tracts covering a larger volume are more likely to be sampled, the tendency to continue straight along a ``path of least resistance'' at diverging or crossing fibres results in inordinate overrepresentation of certain pathways\autocite{Smith2013}.
All this means that, after perhaps hours of tracking and billions of streamlines created, only a handful may be included in a final bundle reconstruction.

\begin{SCfigure}
  \includegraphics[width=0.5\textwidth]{chapter_2/tg_rois_glass.png}
  \caption{\Gls{wm} tracts are virtually dissected with streamline tractography and anatomically informed \glspl{roi}. In this toy example, streamlines for the \gls{cst} are seeded in the cerebral peduncles (blue ring) and selected with an inclusion \gls{roi} in the posterior limb of the internal capsule (green ring). Streamlines following the paths of the \gls{cc} or cerebellar peduncles are excluded (red rings).}
  \label{fig:tg_rois}
\end{SCfigure}

The second approach may be called ``targeted tractography'', and involves only seeding streamlines in a tract-specific \gls{roi} and retaining those that fulfil tract-specific selection criteria, provided as additional inclusion and exclusion regions (Fig. \ref{fig:tg_rois}), until a target number of streamlines have been selected.
A seed region can but does not necessarily have to be placed at one of the actual anatomical ends of the tract, and in some cases it makes more sense to seed from the middle of the tract and propagate bidirectionally, placing additional include regions at the ends to ensure complete coverage.
This approach does not mean that no streamlines are discarded (seeded fibres may be terminated before fulfilling all inclusion criteria, or stray into exclusion regions) but targeted seeding and selection certainly leads to a higher number of admissible streamlines being generated in far less computational time than in the whole brain approach, while discarding unwanted streamlines on the fly reduces storage requirements.
Targeted tractography is the more common approach particularly in applications where only a few or even just a single tract are relevant, such as in neurosurgery\autocite{Yang2021}.

Manual placement of \glspl{roi} in both whole-brain and targeted pipelines represents a significant intellectual burden, relies on expert anatomical knowledge and can be extremely time consuming, so it is often automated by registering structural atlases and defining tracts in terms of logical relations to atlas structures, as in TractQuerier\autocite{Wassermann2016} or a similar proposed method using fuzzy logic\autocite{Delmonte2019}, and Tracula \autocite{Yendiki2011}, or pre-defined \glspl{roi}, as in XTRACT \autocite{Warrington2020}.
The former two are examples of methods that rely on comprehensive cortical parcellations, typically obtained with a software tool such as FreeSurfer\autocite{Desikan2006,FischlSalat2002} which can take many hours to run.
Seed placement may also be optimised using reference tracts, as in probabilistic neighbourhood tractography \autocite{Clayden2006,Clayden2009}.
In many scenarios, manual \gls{roi} placement remains the default method, particularly in clinical contexts where automatic \gls{roi} registration or segmentation may fail due to pathology.
Here, not only is a good understanding of the anatomy of a tract is vital to produce high quality reconstructions, but the user will also need to understand the biases and pitfalls of their chosen \gls{fod} model and tractography algorithm to ensure proper interpretation and qualification of the results\autocite{Rheault2020,Rheault2022}.
Even to an experienced user, producing quality bundles is often time-consuming and tedious.
While modern research applications and increasingly more clinical applications almost exclusively favour probabilistic and multi-fibre \gls{odf} algorithms thanks to higher sensitivity to complex fibre configurations\autocite{Yang2021}, an inevitable trade-off is a high prevalence of false positive streamlines, representing either irrelevant or unphysical connections.
Filtering out these unwanted streamlines remains a considerable challenge\autocite{Jorgens2021}.
Attempts to reduce their creation in the first instance include injecting more anatomical priors into the tracking process, such as by modifying \glspl{fod} to favour the directions associated with the target tract\autocite{Rheault2019}, using directional \glspl{roi} for particularly tricky geometries \autocite{Chamberland2017}, or designing alternatives to the piece-wise linear tracking paradigm that aim to generate streamlines with more anatomical plausibility \autocite{Schomburg2017,Aydogan2021}.
Finally, due to a combination of the different computational methods available, and a general lack of consensus on the precise anatomical extents of many commonly reconstructed pathways, tractography suffers from notoriously low reproducibility\autocite{Schilling2021a}.

In view of these limitations, some in the field are continuing efforts to improve streamline tractography with novel tracking algorithms, finding new ways to incorporate anatomical priors and developing more powerful streamline filtering, clustering and selection strategies.
Others are looking towards white matter segmentation solutions that do not rely on tractography at the point of application, but instead produce voxel-wise tract segmentations directly from \gls{dmri} or \gls{fod} data.

\section{Streamline-free white matter imaging}

There have been numerous works addressing the \gls{wm} tract identification task as a classic voxel-wise segmentation problem, utilising techniques including multi-label supervised clustering \autocite{Ratnarajah2014}, level-set and front propagation\textcite{Nazem-Zadeh2011, Hao2014}, and deep learning for direct segmentation from fibre orientation representations \autocite{Wasserthal2018,Li2020}.
Typically, direct methods require some number of samples with which to train a classifier, atlas, Bayesian model or neural network.

In \textcite{Hagler2009}, a fibre location and orientation atlas is created by averaging the \gls{dt} and tractography-derived information from multiple subjects and subsequently used to estimate the voxel-wise \textit{a posteriori} tract probability in a test subject.
As orientation information was encoded by averaging \gls{dt} principal eigenvectors across subjects this approach is not optimised for crossing fibre configurations.
The spatial probability was given by the averaged, normalised track density values from individual deterministic streamline tractography, although tracking biases discussed above mean that equating streamline density with likelihood of tract location is problematic\autocite{Rheault2019,Smith2013}.
\textcite{Bazin2011} also proposed a direct approach based on diffusion tensor-derived priors (``Diffusion-Oriented Tract Segmentation'', or DOTS) also based on \gls{dt} modelling.
Here the atlas orientation prior consisted of a single principal direction per voxel, and comparisons with the test subject data are made using Markov random field models and neighbouring tensor connectivity.

More recent developments have made use of advances in data science techniques including deep learning segmentation models, of which TractSeg\autocite{Wasserthal2018} and Neuro4Neuro\autocite{Li2020} are notable examples, using \gls{fod} peaks and diffusion tensors as inputs, respectively.
Deep learning-based approaches have the advantage of producing highly reproducible results in short processing time, without the need for template or atlas registration.
However, drawbacks of direct, deep learning-based methods which produce binary segmentations include a lack of explainability, and a dependence on large volumes of annotated training data which are labour-intensive to produce.
This limits their flexibility:
If a user requires a tract segmentation which is either anatomically different or not covered by an existing pre-trained model, then the necessary production of new training data and subsequent model training represents a high logistical and computational barrier.

Inference models trained on large volumes of healthy data may not be entirely robust to pathologies, particularly those causing significant topological changes.
In addition to healthy data, Neuro4Neuro\autocite{Li2020} was validated only in a dementia dataset, and TractSeg\autocite{Wasserthal2018} was qualitatively validated in schizophrenia and autism datasets in the original work.
TractSeg has also been qualitatively validated in a tumour dataset with mostly successful results, with more complete segmentations in cases with minimally deforming tumours.\autocite{Richards2021}
In \textcite{Moshe2022}, the authors trained their own TractSeg model, on approximately 500 datasets, to segment the \gls{cst} in brain tumour patients.
The results were more reproducible than for the compared manual method, and obtained an average \gls{dice} of 0.64, almost 25\% worse than the performance in healthy data reported in the original TractSeg study (for the same tract).
The authors cite a lack of reliable and sufficient labelled training data as a reason for limiting their study to a single tract, despite the importance of other tracts in preoperative fibre mapping.
